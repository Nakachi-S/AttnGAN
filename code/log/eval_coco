Using config:
{'B_VALIDATION': True,
 'CONFIG_NAME': 'eval-coco',
 'CUDA': True,
 'DATASET_NAME': 'coco',
 'DATA_DIR': '/home/nakachi/data/coco/',
 'GAN': {'B_ATTENTION': True,
         'B_DCGAN': False,
         'CONDITION_DIM': 100,
         'DF_DIM': 96,
         'GF_DIM': 48,
         'R_NUM': 3,
         'Z_DIM': 100},
 'GPU_ID': 1,
 'RNN_TYPE': 'LSTM',
 'TEXT': {'CAPTIONS_PER_IMAGE': 5, 'EMBEDDING_DIM': 256, 'WORDS_NUM': 20},
 'TRAIN': {'BATCH_SIZE': 12,
           'B_NET_D': False,
           'DISCRIMINATOR_LR': 0.0002,
           'ENCODER_LR': 0.0002,
           'FLAG': False,
           'GENERATOR_LR': 0.0002,
           'MAX_EPOCH': 600,
           'NET_E': '/home/nakachi/data/models/coco/text_encoder100.pth',
           'NET_G': '/home/nakachi/data/models/coco_AttnGAN2.pth',
           'RNN_GRAD_CLIP': 0.25,
           'SMOOTH': {'GAMMA1': 5.0,
                      'GAMMA2': 5.0,
                      'GAMMA3': 10.0,
                      'LAMBDA': 1.0},
           'SNAPSHOT_INTERVAL': 2000},
 'TREE': {'BASE_SIZE': 64, 'BRANCH_NUM': 3},
 'WORKERS': 1}
Load filenames from: /home/nakachi/data/coco//train_filenames.pickle (82783)
Load filenames from: /home/nakachi/data/coco//val_filenames.pickle (40470)
Load from:  /home/nakachi/data/coco/captions.pickle
Load text encoder from: /home/nakachi/data/models/coco/text_encoder100.pth
Load G from:  /home/nakachi/data/models/coco_AttnGAN2.pth
/home/nakachi/AttnGAN/code/miscc/config.py:103: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  yaml_cfg = edict(yaml.load(f))
/home/nakachi/miniconda3/envs/env/lib/python3.6/site-packages/torch/nn/modules/rnn.py:60: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
step:  0
Make a new folder:  /home/nakachi/data/models/coco_AttnGAN2/valid/single
step:  100
step:  200
step:  300
step:  400
step:  500
step:  600
step:  700
step:  800
step:  900
step:  1000
step:  1100
step:  1200
step:  1300
step:  1400
step:  1500
step:  1600
step:  1700
step:  1800
step:  1900
step:  2000
step:  2100
step:  2200
step:  2300
step:  2400
step:  2500
step:  2600
step:  2700
step:  2800
step:  2900
step:  3000
step:  3100
step:  3200
step:  3300
Total time for training: 1396.2128863334656
